-- Create raw JSON table
CREATE OR REPLACE TABLE weather_json_raw (
  raw VARIANT,
  filename STRING
);

-- Create structured table for flattened data
CREATE OR REPLACE TABLE weatherdata_table (
  CITY_NAME STRING,
  CITY_ID NUMBER,
  TIMEZONE NUMBER,
  TIMESTAMP TIMESTAMP_LTZ,
  COORD_LON FLOAT,
  COORD_LAT FLOAT,
  WEATHER_ID NUMBER,
  WEATHER_MAIN STRING,
  WEATHER_DESCRIPTION STRING,
  WEATHER_ICON STRING,
  TEMP FLOAT,
  FEELS_LIKE FLOAT,
  TEMP_MIN FLOAT,
  TEMP_MAX FLOAT,
  PRESSURE NUMBER,
  HUMIDITY NUMBER,
  SEA_LEVEL NUMBER,
  GRND_LEVEL NUMBER,
  WIND_SPEED FLOAT,
  WIND_DEG NUMBER,
  CLOUD_ALL NUMBER,
  VISIBILITY NUMBER,
  SYS_TYPE NUMBER,
  SYS_ID NUMBER,
  COUNTRY STRING,
  SUNRISE TIMESTAMP_LTZ,
  SUNSET TIMESTAMP_LTZ,
  WIND_GUST FLOAT,
  RAIN_1H FLOAT
);
